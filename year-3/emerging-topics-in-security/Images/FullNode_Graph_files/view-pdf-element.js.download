function t(t,e,s,i){for(var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i,a=t.length-1;a>=0;a--)(o=t[a])&&(r=(n<3?o(r):n>3?o(e,s,r):o(e,s))||r);return n>3&&r&&Object.defineProperty(e,s,r),r}const e=new WeakMap,s=t=>"function"==typeof t&&e.has(t),i="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,o=(t,e,s=null)=>{for(;e!==s;){const s=e.nextSibling;t.removeChild(e),e=s}},n={},r={},a=`{{lit-${String(Math.random()).slice(2)}}}`,l=`\x3c!--${a}--\x3e`,c=new RegExp(`${a}|${l}`);class d{constructor(t,e){this.parts=[],this.element=e;const s=[],i=[],o=document.createTreeWalker(e.content,133,null,!1);let n=0,r=-1,l=0;const{strings:d,values:{length:p}}=t;for(;l<p;){const t=o.nextNode();if(null!==t){if(r++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:s}=e;let i=0;for(let t=0;t<s;t++)h(e[t].name,"$lit$")&&i++;for(;i-- >0;){const e=d[l],s=g.exec(e)[2],i=s.toLowerCase()+"$lit$",o=t.getAttribute(i);t.removeAttribute(i);const n=o.split(c);this.parts.push({type:"attribute",index:r,name:s,strings:n}),l+=n.length-1}}"TEMPLATE"===t.tagName&&(i.push(t),o.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(a)>=0){const i=t.parentNode,o=e.split(c),n=o.length-1;for(let e=0;e<n;e++){let s,n=o[e];if(""===n)s=u();else{const t=g.exec(n);null!==t&&h(t[2],"$lit$")&&(n=n.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),s=document.createTextNode(n)}i.insertBefore(s,t),this.parts.push({type:"node",index:++r})}""===o[n]?(i.insertBefore(u(),t),s.push(t)):t.data=o[n],l+=n}}else if(8===t.nodeType)if(t.data===a){const e=t.parentNode;null!==t.previousSibling&&r!==n||(r++,e.insertBefore(u(),t)),n=r,this.parts.push({type:"node",index:r}),null===t.nextSibling?t.data="":(s.push(t),r--),l++}else{let e=-1;for(;-1!==(e=t.data.indexOf(a,e+1));)this.parts.push({type:"node",index:-1}),l++}}else o.currentNode=i.pop()}for(const t of s)t.parentNode.removeChild(t)}}const h=(t,e)=>{const s=t.length-e.length;return s>=0&&t.slice(s)===e},p=t=>-1!==t.index,u=()=>document.createComment(""),g=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class f{constructor(t,e,s){this.__parts=[],this.template=t,this.processor=e,this.options=s}update(t){let e=0;for(const s of this.__parts)void 0!==s&&s.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=i?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],s=this.template.parts,o=document.createTreeWalker(t,133,null,!1);let n,r=0,a=0,l=o.nextNode();for(;r<s.length;)if(n=s[r],p(n)){for(;a<n.index;)a++,"TEMPLATE"===l.nodeName&&(e.push(l),o.currentNode=l.content),null===(l=o.nextNode())&&(o.currentNode=e.pop(),l=o.nextNode());if("node"===n.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(l.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,n.name,n.strings,this.options));r++}else this.__parts.push(void 0),r++;return i&&(document.adoptNode(t),customElements.upgrade(t)),t}}const m=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),y=` ${a} `;class v{constructor(t,e,s,i){this.strings=t,this.values=e,this.type=s,this.processor=i}getHTML(){const t=this.strings.length-1;let e="",s=!1;for(let i=0;i<t;i++){const t=this.strings[i],o=t.lastIndexOf("\x3c!--");s=(o>-1||s)&&-1===t.indexOf("--\x3e",o+1);const n=g.exec(t);e+=null===n?t+(s?y:l):t.substr(0,n.index)+n[1]+n[2]+"$lit$"+n[3]+a}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");let e=this.getHTML();return void 0!==m&&(e=m.createHTML(e)),t.innerHTML=e,t}}const _=t=>null===t||!("object"==typeof t||"function"==typeof t),b=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class w{constructor(t,e,s){this.dirty=!0,this.element=t,this.name=e,this.strings=s,this.parts=[];for(let t=0;t<s.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new S(this)}_getValue(){const t=this.strings,e=t.length-1,s=this.parts;if(1===e&&""===t[0]&&""===t[1]){const t=s[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!b(t))return t}let i="";for(let o=0;o<e;o++){i+=t[o];const e=s[o];if(void 0!==e){const t=e.value;if(_(t)||!b(t))i+="string"==typeof t?t:String(t);else for(const e of t)i+="string"==typeof e?e:String(e)}}return i+=t[e],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class S{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===n||_(t)&&t===this.value||(this.value=t,s(t)||(this.committer.dirty=!0))}commit(){for(;s(this.value);){const t=this.value;this.value=n,t(this)}this.value!==n&&this.committer.commit()}}class x{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(u()),this.endNode=t.appendChild(u())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=u()),t.__insert(this.endNode=u())}insertAfterPart(t){t.__insert(this.startNode=u()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;s(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=n,t(this)}const t=this.__pendingValue;t!==n&&(_(t)?t!==this.value&&this.__commitText(t):t instanceof v?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):b(t)?this.__commitIterable(t):t===r?(this.value=r,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,s="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=s:this.__commitNode(document.createTextNode(s)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof f&&this.value.template===e)this.value.update(t.values);else{const s=new f(e,t.processor,this.options),i=s._clone();s.update(t.values),this.__commitNode(i),this.value=s}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let s,i=0;for(const o of t)s=e[i],void 0===s&&(s=new x(this.options),e.push(s),0===i?s.appendIntoPart(this):s.insertAfterPart(e[i-1])),s.setValue(o),s.commit(),i++;i<e.length&&(e.length=i,this.clear(s&&s.endNode))}clear(t=this.startNode){o(this.startNode.parentNode,t.nextSibling,this.endNode)}}class P{constructor(t,e,s){if(this.value=void 0,this.__pendingValue=void 0,2!==s.length||""!==s[0]||""!==s[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=s}setValue(t){this.__pendingValue=t}commit(){for(;s(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=n,t(this)}if(this.__pendingValue===n)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=n}}class C extends w{constructor(t,e,s){super(t,e,s),this.single=2===s.length&&""===s[0]&&""===s[1]}_createPart(){return new k(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class k extends S{}let T=!1;(()=>{try{const t={get capture(){return T=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class E{constructor(t,e,s){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=s,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;s(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=n,t(this)}if(this.__pendingValue===n)return;const t=this.__pendingValue,e=this.value,i=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),o=null!=t&&(null==e||i);i&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),o&&(this.__options=N(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=n}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const N=t=>t&&(T?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);const O=new class{handleAttributeExpressions(t,e,s,i){const o=e[0];if("."===o){return new C(t,e.slice(1),s).parts}if("@"===o)return[new E(t,e.slice(1),i.eventContext)];if("?"===o)return[new P(t,e.slice(1),s)];return new w(t,e,s).parts}handleTextExpression(t){return new x(t)}};function M(t){let e=A.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},A.set(t.type,e));let s=e.stringsArray.get(t.strings);if(void 0!==s)return s;const i=t.strings.join(a);return s=e.keyString.get(i),void 0===s&&(s=new d(t,t.getTemplateElement()),e.keyString.set(i,s)),e.stringsArray.set(t.strings,s),s}const A=new Map,V=new WeakMap;"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const z=(t,...e)=>new v(t,e,"html",O);window.JSCompiler_renameProperty=(t,e)=>t;const R={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},L=(t,e)=>e!==t&&(e==e||t==t),I={attribute:!0,type:String,converter:R,reflect:!1,hasChanged:L};class H extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach((e,s)=>{const i=this._attributeNameForProperty(s,e);void 0!==i&&(this._attributeToPropertyMap.set(i,s),t.push(i))}),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((t,e)=>this._classProperties.set(e,t))}}static createProperty(t,e=I){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const s="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,s,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}static getPropertyDescriptor(t,e,s){return{get(){return this[e]},set(i){const o=this[t];this[e]=i,this.requestUpdateInternal(t,o,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||I}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty("finalized")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const s of e)this.createProperty(s,t[s])}}static _attributeNameForProperty(t,e){const s=e.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,s=L){return s(t,e)}static _propertyValueFromAttribute(t,e){const s=e.type,i=e.converter||R,o="function"==typeof i?i:i.fromAttribute;return o?o(t,s):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const s=e.type,i=e.converter;return(i&&i.toAttribute||R.toAttribute)(t,s)}initialize(){this._updateState=0,this._updatePromise=new Promise(t=>this._enableUpdatingResolver=t),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}})}_applyInstanceProperties(){this._instanceProperties.forEach((t,e)=>this[e]=t),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,s){e!==s&&this._attributeToProperty(t,s)}_propertyToAttribute(t,e,s=I){const i=this.constructor,o=i._attributeNameForProperty(t,s);if(void 0!==o){const t=i._propertyValueToAttribute(e,s);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(o):this.setAttribute(o,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const s=this.constructor,i=s._attributeToPropertyMap.get(t);if(void 0!==i){const t=s.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=s._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,s){let i=!0;if(void 0!==t){const o=this.constructor;s=s||o.getPropertyOptions(t),o._valueHasChanged(this[t],e,s.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==s.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,s))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((t,e)=>this._propertyToAttribute(e,this[e],t)),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}H.finalized=!0;const $=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(s){s.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(s){s.createProperty(e.key,t)}};function j(t){return(e,s)=>void 0!==s?((t,e,s)=>{e.constructor.createProperty(s,t)})(t,e,s):$(t,e)}const U=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,W=Symbol();class q{constructor(t,e){if(e!==W)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(U?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const F=(t,...e)=>{const s=e.reduce((e,s,i)=>e+(t=>{if(t instanceof q)return t.cssText;if("number"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(s)+t[i+1],t[0]);return new q(s,W)};(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const D={};class J extends H{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,s)=>t.reduceRight((t,s)=>Array.isArray(s)?e(s,t):(t.add(s),t),s),s=e(t,new Set),i=[];s.forEach(t=>i.unshift(t)),this._styles=i}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map(t=>{if(t instanceof CSSStyleSheet&&!U){const e=Array.prototype.slice.call(t.cssRules).reduce((t,e)=>t+e.cssText,"");return new q(String(e),W)}return t})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?U?this.renderRoot.adoptedStyleSheets=t.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map(t=>t.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==D&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)}))}render(){return D}}J.finalized=!0,J.render=(t,e,s)=>{let i=V.get(e);void 0===i&&(o(e,e.firstChild),V.set(e,i=new x(Object.assign({templateFactory:M},s))),i.appendInto(e)),i.setValue(t),i.commit()},J.shadowRootOptions={mode:"open"};const B={pending:{icon:z``,label:"",show:!1,iconSize:"large"},loading:{icon:z`<svg focusable="false" viewBox="0 0 114 128" class="icon" part="icon"><path d="M99.43 28.64l-7.07-7.07-18.39 18.39 7.07 7.07 18.39-18.39M14.57 99.36l7.07 7.07 18.39-18.39-7.07-7.07-18.39 18.39m59.4-11.32l18.39 18.39 7.07-7.07-18.39-18.39-7.07 7.07m-59.4-59.4l18.39 18.39 7.07-7.07-18.39-18.39-7.07 7.07M86 59h26v10H86V59zM2 59h26v10H2V59zm50 34h10v26H52V93zm0-84h10v26H52V9zm29.04 38.03l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39m-59.4 59.4l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39m59.4-59.4l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39m-59.4 59.4l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39M86 59h26v10H86V59zM2 59h26v10H2V59zm84 0h26v10H86V59zM2 59h26v10H2V59zm90.36 47.43L73.97 88.04l7.07-7.07 18.39 18.39-7.07 7.07m-59.4-59.4L14.57 28.64l7.07-7.07 18.39 18.39-7.07 7.07m59.4 59.4L73.97 88.04l7.07-7.07 18.39 18.39-7.07 7.07m-59.4-59.4L14.57 28.64l7.07-7.07 18.39 18.39-7.07 7.07M52 93h10v26H52V93zm0-84h10v26H52V9zm0 84h10v26H52V93zm0-84h10v26H52V9z"></path></svg>`,label:"Finding PDF...",show:!0,iconSize:"large"},found:{icon:z`<svg focusable="false" viewBox="0 0 32 32" class="icon" part="icon"><path d="M7 .362h17.875l6.763 6.1V31.64H6.948V16z" stroke="#000" stroke-width=".703" fill="#fff"></path><path d="M.167 2.592H22.39V9.72H.166z" stroke="#aaa" stroke-width=".315" fill="#da0000"></path><path fill="#fff9f9" d="M5.97 3.638h1.62c1.053 0 1.483.677 1.488 1.564.008.96-.6 1.564-1.492 1.564h-.644v1.66h-.977V3.64m.977.897v1.34h.542c.27 0 .596-.068.596-.673-.002-.6-.32-.667-.596-.667h-.542m3.8.036v2.92h.35c.933 0 1.223-.448 1.228-1.462.008-1.06-.316-1.45-1.23-1.45h-.347m-.977-.94h1.03c1.68 0 2.523.586 2.534 2.39.01 1.688-.607 2.4-2.534 2.4h-1.03V3.64m4.305 0h2.63v.934h-1.657v.894H16.6V6.4h-1.56v2.026h-.97V3.638"></path><path d="M19.462 13.46c.348 4.274-6.59 16.72-8.508 15.792-1.82-.85 1.53-3.317 2.92-4.366-2.864.894-5.394 3.252-3.837 3.93 2.113.895 7.048-9.25 9.41-15.394zM14.32 24.874c4.767-1.526 14.735-2.974 15.152-1.407.824-3.157-13.72-.37-15.153 1.407zm5.28-5.043c2.31 3.237 9.816 7.498 9.788 3.82-.306 2.046-6.66-1.097-8.925-4.164-4.087-5.534-2.39-8.772-1.682-8.732.917.047 1.074 1.307.67 2.442-.173-1.406-.58-2.44-1.224-2.415-1.835.067-1.905 4.46 1.37 9.065z" fill="#f91d0a"></path></svg>`,label:"View PDF",show:!0,iconSize:"large"},"found-doi":{icon:z`<svg focusable="false" viewBox="1 1 14 14" class="icon" part="icon"><g stroke="none" fill="none"><polyline points="6.8 2 2 2 2 14 14 14 14 9.2" stroke="currentColor" strokeWidth="1"/><polyline points="9 2 14 2 14 7" stroke="currentColor" strokeWidth="1"/><path d="M13.5,2.5 L8.5,7.5" stroke="currentColor" strokeWidth="1"/></g></svg>`,label:"View at publisher",show:!1,iconSize:"large"},failed:{icon:z`<svg viewBox="0 0 100 128" focusable="false" class="icon" part="icon"><path d="M50 14c-18.99-.28-37.3 11.76-44.82 29.14-7.95 17.45-4.3 39.36 8.96 53.22 12.48 13.75 33.08 19.14 50.71 13.36 18.88-5.76 33.13-23.92 34.06-43.67 1.41-18.84-9.32-37.78-26.1-46.41C65.82 15.93 57.92 13.99 50 14zm0 9.6c17.84-.32 34.64 13.09 38.39 30.52 4.11 16.54-4.05 35.03-19 43.19-15.16 8.88-36 5.78-47.9-7.15-12.36-12.5-14.46-33.5-4.82-48.2C23.71 30.68 36.68 23.46 50 23.6zM45 38v10h10V38H45zm0 16v34h10V54H45z"/></svg>`,label:"PDF not found",show:!1,iconSize:"large"}};function Q(t,e){if(t){const e=[""+t];return e.raw=[""+t],z(e)}return e}const Z=Object.keys(B);function G(t){const e=function(t){return t.filter(t=>-1!==Z.indexOf(t.name)).reduce((t,e)=>Object.assign(Object.assign({},t),{[e.name]:{icon:e.icon?Q(e.icon,B[e.name].icon):B[e.name].icon,label:e.label||B[e.name].label,show:"boolean"==typeof e.show?e.show:B[e.name].show,iconSize:e.iconSize||"large"}}),{})}(t);return Object.assign(Object.assign({},B),e)}function Y(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{}}function K(t){const{entityId:e,states:s,rendering:i,integratorId:o,seamlessAccessEnabled:n}=t;return{entityId:tt((null==e?void 0:e.trim())||""),states:s||[],rendering:X((null==i?void 0:i.trim())||""),integratorId:et(o||0),seamlessAccessEnabled:"boolean"!=typeof n||n}}const X=t=>!1===/^(auto|viewport)$/.test(t)?"viewport":t,tt=t=>t&&!1===/^http/.test(t)?(console.warn(`view-pdf-element : ${t} doesn't look like a valid entityId`),""):t,et=t=>"number"==typeof t?t:"string"==typeof t&&/^\d+$/.test(t)?parseInt(t,10):0,st=(t,e=300)=>{let s;return function(){clearTimeout(s),s=setTimeout(()=>t.apply(this),e)}},it=t=>{const{innerHeight:e}=Y();return t.getBoundingClientRect().top<e},ot=F`@keyframes es-spin{0%{transform:rotateZ(0)}100%{transform:rotateZ(360deg)}}:host{display:inline-block;position:relative}.es-link{color:var(--es-color-theme,#007398);cursor:pointer;display:inline-block;font-family:inherit;font-size:inherit;text-decoration:none;transition:color var(--es-animation-hover,.3s) ease,border-bottom-color var(--es-animation-hover,.3s) ease}.es-link:active,.es-link:focus,.es-link:hover{color:var(--es-color-theme-2,#e9711c)}.es-link:active .text,.es-link:focus .text,.es-link:hover .text{border-bottom:2px solid var(--es-color-theme-2,#e9711c)}.es-link.disabled,.es-link.disabled:active,.es-link.disabled:focus,.es-link.disabled:hover{color:var(--es-color-disabled,#b9b9b9);cursor:not-allowed}.es-link.disabled .text,.es-link.disabled:active .text,.es-link.disabled:focus .text,.es-link.disabled:hover .text{border-bottom:0;transition:all 0s ease 0s}.es-link.loading .icon{animation:3s linear infinite es-spin}.es-link .icon,.es-link .text{display:inline-block;vertical-align:middle}.es-link .icon{fill:currentColor;overflow:hidden}.es-link.icon-large svg{height:1.5em;width:1.5em;margin-right:.5em}.es-link.icon-small svg{height:1em;width:1em;margin-right:.3em}.es-link .text{border-bottom:2px solid transparent;transition:border-bottom-color var(--es-animation-hover,.3s)}`;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var nt=function(t,e,s){return t(s={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&s.path)}},s.exports),s.exports}((function(t,e){var s;s=function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}return s.m=t,s.c=e,s.p="",s(0)}([function(t,e){var s=function(){function t(e){var s=this;void 0===e&&(e={processTrackingProperties:{addTrackingProperties:t.defaultAddTrackingProperties,getTrackingProperties:t.defaultGetTrackingProperties},isErrorMessage:t.defaultIsErrorMessage,receiveWindow:window,name:t.createRandomString()}),this.pendingRequestPromises={},this.addTrackingProperties=e.processTrackingProperties&&e.processTrackingProperties.addTrackingProperties||t.defaultAddTrackingProperties,this.getTrackingProperties=e.processTrackingProperties&&e.processTrackingProperties.getTrackingProperties||t.defaultGetTrackingProperties,this.isErrorMessage=e.isErrorMessage||t.defaultIsErrorMessage,this.receiveWindow=e.receiveWindow||window,this.name=e.name||t.createRandomString(),this.logMessages=e.logMessages||!1,this.eventSourceOverrideWindow=e.eventSourceOverrideWindow,this.suppressWarnings=e.suppressWarnings||!1,this.logMessages&&console.log("new WindowPostMessageProxy created with name: "+this.name+" receiving on window: "+this.receiveWindow.document.title),this.handlers=[],this.windowMessageHandler=function(t){return s.onMessageReceived(t)},this.start()}return t.defaultAddTrackingProperties=function(e,s){return e[t.messagePropertyName]=s,e},t.defaultGetTrackingProperties=function(e){return e[t.messagePropertyName]},t.defaultIsErrorMessage=function(t){return!!t.error},t.createDeferred=function(){var t={resolve:null,reject:null,promise:null},e=new Promise((function(e,s){t.resolve=e,t.reject=s}));return t.promise=e,t},t.createRandomString=function(){var t=window.crypto||window.msCrypto,e=new Uint32Array(1);return t.getRandomValues(e),e[0].toString(36).substring(1)},t.prototype.addHandler=function(t){this.handlers.push(t)},t.prototype.removeHandler=function(t){var e=this.handlers.indexOf(t);if(-1===e)throw new Error("You attempted to remove a handler but no matching handler was found.");this.handlers.splice(e,1)},t.prototype.start=function(){this.receiveWindow.addEventListener("message",this.windowMessageHandler)},t.prototype.stop=function(){this.receiveWindow.removeEventListener("message",this.windowMessageHandler)},t.prototype.postMessage=function(e,s){var i={id:t.createRandomString()};this.addTrackingProperties(s,i),this.logMessages&&(console.log(this.name+" Posting message:"),console.log(JSON.stringify(s,null,"  "))),e.postMessage(s,"*");var o=t.createDeferred();return this.pendingRequestPromises[i.id]=o,o.promise},t.prototype.sendResponse=function(t,e,s){this.addTrackingProperties(e,s),this.logMessages&&(console.log(this.name+" Sending response:"),console.log(JSON.stringify(e,null,"  "))),t.postMessage(e,"*")},t.prototype.onMessageReceived=function(t){var e=this;this.logMessages&&(console.log(this.name+" Received message:"),console.log("type: "+t.type),console.log(JSON.stringify(t.data,null,"  ")));var s=this.eventSourceOverrideWindow||t.source,i=t.data;if("object"==typeof i){var o,n;try{o=this.getTrackingProperties(i)}catch(t){this.suppressWarnings||console.warn("Proxy("+this.name+"): Error occurred when attempting to get tracking properties from incoming message:",JSON.stringify(i,null,"  "),"Error: ",t)}if(o&&(n=this.pendingRequestPromises[o.id]),n){var r=!0;try{r=this.isErrorMessage(i)}catch(t){console.warn("Proxy("+this.name+") Error occurred when trying to determine if message is consider an error response. Message: ",JSON.stringify(i,null,""),"Error: ",t)}r?n.reject(i):n.resolve(i),delete this.pendingRequestPromises[o.id]}else this.handlers.some((function(t){var n=!1;try{n=t.test(i)}catch(t){e.suppressWarnings||console.warn("Proxy("+e.name+"): Error occurred when handler was testing incoming message:",JSON.stringify(i,null,"  "),"Error: ",t)}if(n){var r=void 0;try{r=Promise.resolve(t.handle(i))}catch(t){e.suppressWarnings||console.warn("Proxy("+e.name+"): Error occurred when handler was processing incoming message:",JSON.stringify(i,null,"  "),"Error: ",t),r=Promise.resolve()}return r.then((function(t){if(!t){var n="Handler for message: "+JSON.stringify(i,null,"  ")+" did not return a response message. The default response message will be returned instead.";e.suppressWarnings||console.warn("Proxy("+e.name+"): "+n),t={warning:n}}e.sendResponse(s,t,o)})),!0}}))||this.suppressWarnings||console.warn("Proxy("+this.name+") did not handle message. Handlers: "+this.handlers.length+"  Message: "+JSON.stringify(i,null,"")+".")}else this.suppressWarnings||console.warn("Proxy("+this.name+"): Received message that was not an object. Discarding message")},t.messagePropertyName="windowPostMessageProxy",t}();e.WindowPostMessageProxy=s}])},t.exports=s()}));class rt{constructor(t,e){this.identifier=t,this.args=e,this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}const at=new nt.WindowPostMessageProxy({suppressWarnings:!0});class lt{constructor(t,e,s,i){this.messageTimeout=3e3,this.deferrals=[],this.maxConcurrency=10,this.integratorId=0,this.iframe=t,this.iframeLoaded=e,this.waitFor=s,this.docLocation=function(){const t=Y().location||document.location;return t instanceof Location&&/^http/.test(t.origin)?{origin:t.origin,pathname:t.pathname,href:t.href}:{}}(),this.integratorId=i}enqueue(t,...e){let s=this.deferrals.find(e=>e.identifier===t);return void 0===s&&(s=new rt(t,e),this.deferrals.push(s),clearTimeout(this.timer),this.deferrals.length<this.maxConcurrency?this.timer=setTimeout(()=>{this.dequeue()},this.waitFor):this.dequeue()),s.promise}dequeue(){const t=this.deferrals.length<this.maxConcurrency?this.deferrals.length:this.maxConcurrency,e=this.deferrals.splice(0,t);this.deferrals.length&&(this.timer=setTimeout(()=>{this.dequeue()},this.waitFor)),this.process(e)}process(t){const{origin:e,pathname:s}=this.docLocation,i=e?`${e}${s}`:"",o={data:t.map(t=>t.args[0]),origin:i,integratorId:this.integratorId,version:"0.8.9"};this.iframeLoaded.then(()=>{const t=o.data.map(t=>({data:{doc_id:t.doc_id,entitled:!1}}));if(!o.origin)return Promise.resolve(t.map(t=>({data:Object.assign(Object.assign({},t.data),{reason:yt.NoLocation})})));const e=new Promise((e,s)=>{setTimeout(()=>{e(t.map(t=>({data:Object.assign(Object.assign({},t.data),{reason:yt.Timeout})})))},this.messageTimeout)});return Promise.race([at.postMessage(this.iframe.contentWindow,o),e])}).then(e=>{e.forEach(e=>{const s=t.find(t=>t.identifier===e.data.doc_id.toLowerCase());void 0!==s&&s.resolve(e)})}).catch(e=>{t.forEach(t=>{t.reject(e.message)})})}}const ct=z`<svg viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="getftr-indicator" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Group"><path d="M16,8 C16,12.418278 12.418278,16 8,16 C6.59867593,16 5.28150419,15.6397011 4.13606886,15.0066873 L5.12608495,14.0171168 C5.99629904,14.4335007 6.9709201,14.6666667 8,14.6666667 C11.6818983,14.6666667 14.6666667,11.6818983 14.6666667,8 C14.6666667,6.9709201 14.4335007,5.99629904 14.0171168,5.12608495 L15.0066873,4.13606886 C15.6397011,5.28150419 16,6.59867593 16,8 Z M8,-6.31593543e-15 C9.40173072,-6.31593543e-15 10.7192603,0.360508061 11.8649283,0.993863819 L10.8749187,1.98336356 C10.0044504,1.56667866 9.02947555,1.33333333 8,1.33333333 C4.31810167,1.33333333 1.33333333,4.31810167 1.33333333,8 C1.33333333,9.02947555 1.56667866,10.0044504 1.98336356,10.8749187 L0.993863819,11.8649283 C0.360508061,10.7192603 0,9.40173072 0,8 C0,3.581722 3.581722,-6.31593543e-15 8,-6.31593543e-15 Z" id="Combined-Shape" fill="#0D8D8A" fill-rule="nonzero"></path><circle id="Oval" fill="#096A73" cx="8" cy="8" r="3.55555556"></circle></g></g></svg>`;class dt extends J{constructor(){super(...arguments),this.placement="top",this.positionOffset=dt.tooltipOffset}get show(){return this._show.toString()}set show(t){t&&"true"===t?(this._show=!0,this.classList.remove("hide"),setTimeout(()=>{this.classList.add("show")})):(this.classList.remove("show"),this._show=!1)}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this.addEventListener("transitionend",()=>{this.classList.contains("show")||this.classList.add("hide")})}getReferenceElStyles(){const t=this.parentNode.querySelector("a");if(!t)return{clientHeight:0,clientWidth:0};const{clientHeight:e,clientWidth:s}=t;return{clientHeight:e,clientWidth:s}}setPositions(){const{clientHeight:t,clientWidth:e}=this.getReferenceElStyles();["top","bottom","left","right"].forEach(t=>this.style[t]=null),"top"===this.placement?(this.style.left="50%",this.style.bottom=t+this._arrowSize+this.positionOffset+"px"):"bottom"===this.placement?(this.style.left="50%",this.style.top=t+this._arrowSize+this.positionOffset+"px"):"left"===this.placement?(this.style.top=(t-this.clientHeight)/2+"px",this.style.right=e+this._arrowSize+this.positionOffset+"px"):(this.style.top=(t-this.clientHeight)/2+"px",this.style.left=e+this._arrowSize+this.positionOffset+"px")}render(){return this.accessType?z`<div class="tooltip-container ${this.placement}" part="tooltip-container"><div class="icon">${ct}</div><p class="message" part="tooltip-message">${"paid"===this.accessType.toLocaleLowerCase()?"Your institution provides access to this article.":"This article is free to access."}</p></div>`:null}updated(){if(!this.accessType)return;const t=globalThis.getComputedStyle(this.querySelector(".tooltip-container"),":before"),e=t=>{const e=parseInt(t,10);return isNaN(e)?0:e};["left","right"].includes(this.placement)?this._arrowSize=e(t.width)||8:this._arrowSize=e(t.borderBottomWidth)||e(t.borderTopWidth)||14,this.setPositions(),this._show||this.classList.add("hide")}}dt.tooltipOffset=6,t([j()],dt.prototype,"show",null),t([j({attribute:"access-type"})],dt.prototype,"accessType",void 0),t([j()],dt.prototype,"placement",void 0),t([j({type:Number,attribute:"position-offset"})],dt.prototype,"positionOffset",void 0),customElements.get("getftr-tooltip")||customElements.define("getftr-tooltip",dt);const ht=F`.fade{transition:opacity .3s linear}.fade:not(.show){opacity:0}.show{display:inline-block;opacity:1}.hide{display:none}getftr-tooltip{position:absolute;padding:.5em .7em;background-color:var(--es-color-tooltip-bg,#ebebeb);font-size:var(--es-base-font-size-tooltip,16px);z-index:1000;min-width:15em}getftr-tooltip.top{border-bottom:2px solid var(--es-color-tooltip-border-bottom,#e9711c)}getftr-tooltip.bottom{border-top:2px solid var(--es-color-tooltip-border-bottom,#e9711c)}getftr-tooltip.left{border-right:2px solid var(--es-color-tooltip-border-bottom,#e9711c)}getftr-tooltip.right{border-left:2px solid var(--es-color-tooltip-border-bottom,#e9711c)}.tooltip-container{display:flex}.tooltip-container>.icon{margin-right:.5em;width:1em;height:1em}.tooltip-container>.icon>svg{width:1em;height:1em}.tooltip-container>p{flex-grow:1;margin:0;padding:0}.tooltip-container::after,.tooltip-container::before{border-left:14px solid transparent;content:"";height:0;position:absolute;width:0;left:0}.tooltip-container.top::before{bottom:-14px;border-top:14px solid var(--es-color-tooltip-border-bottom,#e9711c)}.tooltip-container.top::after{bottom:-11px;border-top:14px solid var(--es-color-tooltip-bg,#ebebeb)}.tooltip-container.bottom::before{top:-14px;border-bottom:14px solid var(--es-color-tooltip-border-bottom,#e9711c)}.tooltip-container.bottom::after{top:-11px;border-bottom:14px solid var(--es-color-tooltip-bg,#ebebeb)}.tooltip-container.left::before{z-index:1001;background-color:var(--es-color-tooltip-bg,#ebebeb)}.tooltip-container.left::after{left:calc(100% + 8px / -2 + 2px)!important;z-index:1000;background-color:var(--es-color-tooltip-border-bottom,#e9711c)}.tooltip-container.right::before{z-index:1001;background-color:var(--es-color-tooltip-bg,#ebebeb)}.tooltip-container.right::after{left:calc(8px / -2 - 2px)!important;z-index:1000;background-color:var(--es-color-tooltip-border-bottom,#e9711c)}.tooltip-container.top::after,.tooltip-container.top::before{left:0;transform:rotate(270deg)}.tooltip-container.bottom::after,.tooltip-container.bottom::before{left:0;transform:rotate(-270deg)}.tooltip-container.left::after,.tooltip-container.left::before{width:8px;height:8px;border:none!important;top:calc(50% - 8px / 2);left:calc(100% + 8px / -2 - 1px);transform:rotate(-45deg)}.tooltip-container.right::after,.tooltip-container.right::before{width:8px;height:8px;border:none!important;top:calc(50% - 8px / 2);left:calc(8px / -2 + 1px);transform:rotate(-45deg)}`,pt="https://unpkg.com/@theidentityselector/thiss-ds@1.0.13/dist/thiss-ds.js";function ut(t){const{thiss:e}=globalThis;if(void 0===e){const e=function(t){const e=document.createElement("script");return e.setAttribute("id","view-pdf-seamless-access"),e.setAttribute("src",t),e}(pt);return document.body.append(e),function(t,e,s=1500){let i;const o=new Promise(s=>{t.addEventListener("load",()=>{clearTimeout(i),s(new globalThis.thiss.PersistenceService(e))})}),n=new Promise(t=>i=setTimeout(()=>{console.info(`view-pdf-element: Timeout of ${s}ms exceeded in loading ${pt}`),t({entities:void 0})},s));return Promise.race([o,n])}(e,t)}return Promise.resolve(new e.PersistenceService(t))}const gt=(()=>{const t=("__els_pdf_bridge___"+(()=>{const t=window.location,e=t.host;return`${t.protocol}//${e}`})()).replace(/[^a-zA-Z0-9]+/g,"_"),e=document.createElement("iframe");return e.setAttribute("name",t),e.setAttribute("id",t),e.setAttribute("style","display: none; margin: 0; padding: 0; border: 0px none; overflow: hidden;"),e.setAttribute("frameborder","0"),e.setAttribute("border","0"),e.setAttribute("scrolling","no"),e.setAttribute("allowTransparency","true"),e.setAttribute("tabindex","-1"),e.setAttribute("hidden","true"),e.setAttribute("title",""),e.setAttribute("role","presentation"),e.src="https://brxt-research.mendeley.com/",e})(),ft={targetIframe:gt,iframeLoaded:(mt=gt,document.body.appendChild(mt),new Promise(t=>{mt.addEventListener("load",()=>{t()})})),messageQueueMap:new Map,waitForQueue:50,isScrollEventListenerSet:!1};var mt,yt;!function(t){t.NoLocation="Document location is not available on users browser",t.Timeout="Server timeout",t.NoFullTextsFound="No full-text links found"}(yt||(yt={}));let vt=class extends J{constructor(){super(),this._elementConfig={},this._localConfig={},this._tooltipShow=!1,this._tooltipPlacement="top",this._tooltipOffset=6,this.disabled=!0}connectedCallback(){super.connectedCallback(),this.state="pending",void 0===ft.globalConfig&&(ft.globalConfig=function(){var t;const e=document.querySelectorAll("script[data-config]"),s=Array.from(e).find(t=>t.getAttribute("src").includes("view-pdf-element"));let i={};try{i=Object.assign({},JSON.parse(s.dataset.config))}catch(e){(null===(t=null==s?void 0:s.dataset)||void 0===t?void 0:t.config)&&console.warn("failed to parse JSON stringfied configuration for some reason")}return Object.assign({},K(i))}()),this._elementConfig=function(t,e){return t.integratorId?Object.assign({},t):e.integratorId?Object.assign({},e):K({})}(this._localConfig,ft.globalConfig);const{integratorId:t,states:e,seamlessAccessEnabled:s}=this._elementConfig;s&&void 0===ft.persistenceService&&(ft.persistenceService=ut("https://use.thiss.io/ps")),this._stateMap=G(e),t?(this.initMessageQueue(t),this.init()):console.error("view-pdf-element : integratorId is missing in your config")}initMessageQueue(t){if(!ft.messageQueueMap.has(t)){const{targetIframe:e,iframeLoaded:s,waitForQueue:i}=ft;ft.messageQueueMap.set(t,new lt(e,s,i,t))}}createRenderRoot(){return this.attachShadow({mode:"open",delegatesFocus:!0})}async init(){const{rendering:t,entityId:e,seamlessAccessEnabled:s}=this._elementConfig;if(!e&&s&&void 0===ft.seamlessAccessEntityID){const t=await ft.persistenceService;ft.seamlessAccessEntityID=await async function(t,e){try{const s=new URL(e).host.split(".").splice(1).join("."),{data:i}=await t.entities(s);if(!i.length)return"";return i.sort((t,e)=>e.last_refresh-t.last_refresh)[0].entity.entityID}catch(t){return""}}(t,"https://use.thiss.io/ps"),this._elementConfig=Object.assign(Object.assign({},this._elementConfig),{entityId:ft.seamlessAccessEntityID})}"viewport"===t?(this.triggerEntitlementCheckQueue(),ft.isScrollEventListenerSet||(window.addEventListener("scroll",st(()=>{const t=document.querySelectorAll("els-view-pdf-element.pending");for(const e of t){if(!it(e))break;e.handleLoaded()}},150)),ft.isScrollEventListenerSet=!0)):this.handleLoaded()}handleLoaded(){this.docId&&this.docType?(this.state="loading",ft.iframeLoaded.then(()=>this.sendMessage(!1))):this.classList.contains("loop")&&(this.state="loading")}sendMessage(t){const{entityId:e}=this._elementConfig,s={doc_type:this.docType,doc_id:this.docId};e&&(s.entity_id=e);try{ft.messageQueueMap.get(this._elementConfig.integratorId).enqueue(s.doc_id.toLowerCase(),s).then(e=>this.handleResponseMessage(e,t)).catch(()=>{const t={data:{doc_id:this.docId,entitled:!1}};this.handleResponseMessage(t,!1)})}catch(t){console.warn(`view-pdf-element : MessageQueue for integratorId ${this._elementConfig.integratorId} is not found`)}}handleResponseMessage(t,e){const{entitled:s,vors:i=[],reason:o}=t.data;this._reason=o,s&&i.length?(this._bestVoR=i[0],this.state="found",e&&window.open(this._bestVoR.url,"_blank")):"doi"===this.docType?this.state="found-doi":this.state="failed"}handleClick(t){switch(t.preventDefault(),this.state){case"found-doi":window.open("https://www.doi.org/"+this.docId,"_blank");break;case"found":this.sendMessage(!0)}const{access_type:e="",content_type:s="",source:i=""}=this._bestVoR||{};this.dispatchEvent(new CustomEvent("els-view-pdf-click",{bubbles:!0,detail:{doc_type:this.docType,doc_id:this.docId,entity_id:this._elementConfig.entityId,state:this.state,full_text:{access_type:e,content_type:s,source:i}}}))}handleShowTooltip(t){var e;if("getftr"===(null===(e=this._bestVoR)||void 0===e?void 0:e.source)){const e=this.shadowRoot.querySelector("getftr-tooltip");if(!e)return;e.setAttribute("show",t.toString())}}tooltipTemplate(){var t;return"getftr"===(null===(t=this._bestVoR)||void 0===t?void 0:t.source)?z`<getftr-tooltip access-type="${this._bestVoR.access_type}" placement="${this._tooltipPlacement}" position-offset="${this._tooltipOffset}" show="${this._tooltipShow}" class="fade ${this._tooltipPlacement}" part="getftr-tooltip"></getftr-tooltip>`:null}triggerEntitlementCheckQueue(){it(this)&&this.handleLoaded()}updateElementClass(t,e){this.classList.remove(t),this.classList.add(e)}get elementConfig(){return this._elementConfig}get label(){return this._stateMap[this.state].label}get icon(){return this._stateMap[this.state].icon}get state(){return this._state}set state(t){if(this._state===t)return;if("found"===this._state)return void this.updateElementClass(t,this._state);const e=["failed","found-doi"];if(this.disabled=["failed","loading"].includes(t),!["pending","loading"].includes(t)){const{access_type:s="",content_type:i="",source:o=""}=this._bestVoR||{},n={doc_type:this.docType,doc_id:this.docId,state:t,full_text:{access_type:s,content_type:i,source:o}};this.dispatchEvent(new CustomEvent("els-view-pdf-complete",{detail:e.includes(t)?Object.assign(Object.assign({},n),{reason:this._reason}):n}))}this.updateElementClass(this._state,t),this._state=t,this.requestUpdate()}get dataConfig(){return this._dataConfig}set dataConfig(t){try{this._localConfig=K(JSON.parse(t))}catch(t){this._localConfig={}}this._dataConfig=JSON.stringify(this._localConfig)}get tooltipPlacement(){return this._tooltipPlacement}set tooltipPlacement(t){["top","left","bottom","right"].includes(t)?this._tooltipPlacement=t:this._tooltipPlacement="top",this.requestUpdate("tooltipPlacement",this._tooltipPlacement)}get tooltipOffset(){return this._tooltipOffset}set tooltipOffset(t){t&&!isNaN(t)?this._tooltipOffset=t:this._tooltipOffset=dt.tooltipOffset,this.requestUpdate("tooltipOffset",this._tooltipOffset)}render(){const{state:t,icon:e,label:s,disabled:i,iconSize:o="",_stateMap:n}=this,r=o||n[t].iconSize;return"pending"!==t&&n[t].show?z`<a href="javascript:;" target="_blank" class="es-link ${t} ${i?"disabled":""} icon-${r}" @click="${this.handleClick}" part="container" @mouseover="${()=>this.handleShowTooltip(!0)}" @mouseout="${()=>this.handleShowTooltip(!1)}">${e} <span class="text" part="label">${s}</span> </a>${this.tooltipTemplate()}`:null}};var _t;vt.styles=[ot,ht],t([j({type:Boolean,reflect:!0})],vt.prototype,"disabled",void 0),t([j({type:String,attribute:"doc-type"})],vt.prototype,"docType",void 0),t([j({type:String,attribute:"doc-id"})],vt.prototype,"docId",void 0),t([j({type:String,attribute:"icon-size"})],vt.prototype,"iconSize",void 0),t([j({type:String,attribute:"data-config"})],vt.prototype,"dataConfig",null),t([j({type:String,attribute:"tooltip-placement"})],vt.prototype,"tooltipPlacement",null),t([j({type:Number,attribute:"tooltip-offset",converter:t=>{const e=parseInt(t,10);return isNaN(e)?0:e}})],vt.prototype,"tooltipOffset",null),vt=t([(_t="els-view-pdf-element",t=>"function"==typeof t?((t,e)=>(window.customElements.define(t,e),e))(_t,t):((t,e)=>{const{kind:s,elements:i}=e;return{kind:s,elements:i,finisher(e){window.customElements.define(t,e)}}})(_t,t))],vt);export{ft as Context,yt as Reason,vt as ViewPDFElement};
//# sourceMappingURL=view-pdf-element.js.map
